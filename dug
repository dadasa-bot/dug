-- CONFIGURATION
getgenv().AimbotSettings = {
    Enabled = true,
    Prediction = 0.15,
    Smoothness = 0.12
}

-- SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- STATE
local AimbotOn = false
local Target = nil

-- FUNCTIONS
local function GetClosestPlayer()
    local closestDistance = math.huge
    local closestPlayer = nil

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local head = player.Character.Head
            local screenPoint, onScreen = Camera:WorldToViewportPoint(head.Position)
            if onScreen then
                local inputPosition = UserInputService:GetMouseLocation()
                local distance = (Vector2.new(inputPosition.X, inputPosition.Y) - Vector2.new(screenPoint.X, screenPoint.Y)).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestPlayer = player
                end
            end
        end
    end

    return closestPlayer
end

-- AIMBOT LOOP
RunService.RenderStepped:Connect(function()
    if AimbotOn and Target and Target.Character and Target.Character:FindFirstChild("Head") then
        local head = Target.Character.Head
        local predictedPosition = head.Position + (head.Velocity * getgenv().AimbotSettings.Prediction)
        local direction = (predictedPosition - Camera.CFrame.Position).Unit
        local newCF = CFrame.new(Camera.CFrame.Position, Camera.CFrame.Position + direction)
        Camera.CFrame = Camera.CFrame:Lerp(newCF, getgenv().AimbotSettings.Smoothness)
    end
end)

-- MOBILE UI BUTTON
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game:GetService("CoreGui")
screenGui.Name = "AimbotMobileUI"

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 120, 0, 50)
toggleButton.Position = UDim2.new(0.8, 0, 0.85, 0)
toggleButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 18
toggleButton.Text = "Aimbot: OFF"
toggleButton.Parent = screenGui

toggleButton.MouseButton1Click:Connect(function()
    AimbotOn = not AimbotOn
    toggleButton.Text = AimbotOn and "Aimbot: ON" or "Aimbot: OFF"
    if AimbotOn then
        Target = GetClosestPlayer()
    else
        Target = nil
    end
end)

-- PC support (right mouse button)
UserInputService.InputBegan:Connect(function(input, processed)
    if not processed and input.UserInputType == Enum.UserInputType.MouseButton2 then
        AimbotOn = true
        Target = GetClosestPlayer()
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 then
        AimbotOn = false
        Target = nil
    end
end)

